<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>rsofun BiomeE driver data (Leuning photosynthesis model) — biomee_gs_leuning_drivers • rsofun</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rsofun BiomeE driver data (Leuning photosynthesis model) — biomee_gs_leuning_drivers"><meta name="description" content="Example driver to run the BiomeE-model at the CH-LAE site
using the Leuning photosynthesis specification (and half-hourly time step)
It can also be used together with leaf trait data from CH-LAE (biomee_validation)
to optimize model parameters."><meta property="og:description" content="Example driver to run the BiomeE-model at the CH-LAE site
using the Leuning photosynthesis specification (and half-hourly time step)
It can also be used together with leaf trait data from CH-LAE (biomee_validation)
to optimize model parameters."></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsofun</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/geco-bern/rsofun/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>rsofun BiomeE driver data (Leuning photosynthesis model)</h1>
      <small class="dont-index">Source: <a href="https://github.com/geco-bern/rsofun/blob/master/R/data.R" class="external-link"><code>R/data.R</code></a></small>
      <div class="d-none name"><code>biomee_gs_leuning_drivers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Example driver to run the BiomeE-model at the CH-LAE site
using the Leuning photosynthesis specification (and half-hourly time step)
It can also be used together with leaf trait data from CH-LAE (<code><a href="biomee_validation.html">biomee_validation</a></code>)
to optimize model parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">biomee_gs_leuning_drivers</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A tibble of driver data.</p><dl><dt>sitename</dt>
<dd><p>Site name</p></dd>

  <dt>params_siml</dt>
<dd><p>Simulation parameters as a data.frame, including
  the following data:</p><dl><dt>spinup</dt>
<dd><p>Flag indicating whether this simulation does spin-up (deprecated).</p></dd>

      <dt>spinupyears</dt>
<dd><p>Number of spin-up years. Set to 0 for no spinup.</p></dd>

      <dt>recycle</dt>
<dd><p>Number of first N years of forcing data.frame that are recycled for spin-up.</p></dd>

      <dt>firstyeartrend</dt>
<dd><p>Year of first transient year (AD) (optional). Is only used to set years in output data frames. Defaults to 0 if not provided.</p></dd>

      <dt>nyeartrend</dt>
<dd><p>Number of transient years (optional). Determines the length of simulation output after spin-up. Defaults to number of years contained in the forcing data. (If longer than forcing data, last year of forcing is repeated until the end (spin-down).)</p></dd>

      <dt>steps_per_day</dt>
<dd><p>Time resolution of the forcing (day-1).</p></dd>

      <dt>do_U_shaped_mortality</dt>
<dd><p>Flag indicating whether U-shaped mortality is used.</p></dd>

      <dt>do_closedN_run</dt>
<dd><p>Flag indicating whether doing N closed runs to recover N balance enforcing 0.2 kg N m-2 in the inorganic N pool.</p></dd>

      <dt>method_photosynth</dt>
<dd><p>String specifying the method of photosynthesis used in the model, either "pmodel" or "gs_leuning".document()</p></dd>

      <dt>method_mortality</dt>
<dd><p>String indicating the type of mortality in the
        model. One of the following: "dbh" is size-dependent mortality, "const_selfthin"
        is constant self thinning (in development), "cstarvation" is carbon starvation, and
        "growthrate" is growth rate dependent mortality.</p></dd>

      <dt>do_daily_diagnostics</dt>
<dd><p>Whether to output daily diagnostics ('output_daily_tile'). Default: True.</p></dd>


</dl></dd>

  <dt>site_info</dt>
<dd><p>Site meta info in a data.frame.
This data structure can be freely used for documenting the dataset, but must include at least the following data:</p><dl><dt>lon</dt>
<dd><p>Longitude of the site location in degrees east.</p></dd>

      <dt>lat</dt>
<dd><p>Latitude of the site location in degrees north.</p></dd>

      <dt>elv</dt>
<dd><p>Elevation of the site location, in meters above sea level.</p></dd>


</dl></dd>

  <dt>forcing</dt>
<dd><p>Forcing data.frame used as input</p><dl><dt>ppfd</dt>
<dd><p>Photosynthetic photon flux density (mol m-2 s-1)</p></dd>

      <dt>tair</dt>
<dd><p>Air temperature (deg C)</p></dd>

      <dt>vpd</dt>
<dd><p>Vapor pressure deficit (Pa)</p></dd>

      <dt>rain</dt>
<dd><p>Precipitation (kgH2O m-2 s-1 == mm s-1)</p></dd>

      <dt>wind</dt>
<dd><p>Wind velocity (m s-1)</p></dd>

      <dt>pair</dt>
<dd><p>Atmospheric pressure (Pa)</p></dd>

      <dt>co2</dt>
<dd><p>Atmospheric CO\(_2\) concentration in ppm.</p></dd>


</dl></dd>

  <dt>params_tile</dt>
<dd><p>Tile-level model parameters, into a single row data.frame, including the following data:</p><dl><dt>soiltype</dt>
<dd><p>Integer indicating the type of soil: Sand = 1, LoamySand = 2, SandyLoam = 3, SiltLoam = 4, FrittedClay = 5, Loam = 6, Clay = 7.</p></dd>

      <dt>FLDCAP</dt>
<dd><p>Field capacity (vol/vol). Water remaining in a soil after it has been thoroughly saturated and allowed to drain freely.</p></dd>

      <dt>WILTPT</dt>
<dd><p>Wilting point (vol/vol). Water content of a soil at which plants wilt and fail to recover.</p></dd>

      <dt>K1</dt>
<dd><p>Fast soil C decomposition rate (yr\(^{-1}\)).</p></dd>

      <dt>K2</dt>
<dd><p>Slow soil C decomposition rate (yr\(^{-1}\)).</p></dd>

      <dt>K_nitrogen</dt>
<dd><p>Mineral Nitrogen turnover rate (yr\(^{-1}\)).</p></dd>

      <dt>MLmixRatio</dt>
<dd><p>Ratio of C and N returned to litters from microbes.</p></dd>

      <dt>etaN</dt>
<dd><p>N loss rate through runoff (organic and mineral) (yr\(^{-1}\)).</p></dd>

      <dt>LMAmin</dt>
<dd><p>Minimum LMA, leaf mass per unit area, kg C m\(^{-2}\).</p></dd>

      <dt>fsc_fine</dt>
<dd><p>Fraction of fast turnover carbon in fine biomass.</p></dd>

      <dt>fsc_wood</dt>
<dd><p>Fraction of fast turnover carbon in wood biomass.</p></dd>

      <dt>GR_factor</dt>
<dd><p>Growth respiration factor.</p></dd>

      <dt>l_fract</dt>
<dd><p>Fraction of the carbon retained after leaf drop.</p></dd>

      <dt>retransN</dt>
<dd><p>Retranslocation coefficient of nitrogen.</p></dd>

      <dt>f_initialBSW</dt>
<dd><p>Coefficient for setting up initial sapwood.</p></dd>

      <dt>f_N_add</dt>
<dd><p>Re-fill of N for sapwood.</p></dd>

      <dt>tf_base</dt>
<dd><p>Calibratable scalar for respiration, used to increase LUE levels.</p></dd>

      <dt>par_mort</dt>
<dd><p>Canopy mortality parameter.</p></dd>

      <dt>par_mort_under</dt>
<dd><p>Parameter for understory mortality.</p></dd>


</dl></dd>

  <dt>params_species</dt>
<dd><p>A data.frame containing species-specific model parameters, with one species per row, including the following data:</p><dl><dt>The following columns pertaining to the <b>plant type</b>:</dt>
<dd><dl><dt>lifeform</dt>
<dd><p>Integer set to 0 for grasses and 1 for trees.</p></dd>

      <dt>phenotype</dt>
<dd><p>Integer set to 0 for deciduous and 1 for evergreen.</p></dd>

      <dt>pt</dt>
<dd><p>Integer indicating the type of plant according to photosynthesis: 0 for C3; 1 for C4</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>root parameters</b>:</dt>
<dd><dl><dt>alpha_FR</dt>
<dd><p>Fine root turnover rate (yr\(^{-1}\)).</p></dd>

      <dt>rho_FR</dt>
<dd><p>Material density of fine roots (kg C m\(^{-3}\)).</p></dd>

      <dt>root_r</dt>
<dd><p>Radius of the fine roots, in m.</p></dd>

      <dt>root_zeta</dt>
<dd><p>e-folding parameter of root vertical distribution, in m.</p></dd>

      <dt>Kw_root</dt>
<dd><p>Fine root water conductivity (mol m\(^{-2}\) s\(^{-1}\) MPa\(^{-1}\)).</p></dd>

      <dt>leaf_size</dt>
<dd><p>Characteristic leaf size.</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>photosynthesis parameters</b>:</dt>
<dd><dl><dt>Vmax</dt>
<dd><p>Max RuBisCo rate, in mol m\(^{-2}\) s\(^{-1}\).</p></dd>

      <dt>Vannual</dt>
<dd><p>Annual productivity per unit area at full sun (kg C m\(^{-2}\) year\(^{-2}\)).</p></dd>

      <dt>wet_leaf_dreg</dt>
<dd><p>Wet leaf photosynthesis down-regulation.</p></dd>

      <dt>m_cond</dt>
<dd><p>Factor of stomatal conductance.</p></dd>

      <dt>alpha_phot</dt>
<dd><p>Photosynthesis efficiency.</p></dd>

      <dt>gamma_L</dt>
<dd><p>Leaf respiration coefficient, in yr\(^{-1}\).</p></dd>

      <dt>gamma_LN</dt>
<dd><p>Leaf respiration coefficient per unit N.</p></dd>

      <dt>gamma_SW</dt>
<dd><p>Sapwood respiration rate, in kg C m\(^{-2}\) yr\(^{-1}\).</p></dd>

      <dt>gamma_FR</dt>
<dd><p>Fine root respiration rate, kg C kg C\(^{-1}\) yr\(^{-1}\).</p></dd>

      <dt>tk_crit</dt>
<dd><p>Critical temperature triggerng offset of phenology, in Kelvin.</p></dd>

      <dt>tk_crit_on</dt>
<dd><p>Critical temperature triggerng onset of phenology, in Kelvin.</p></dd>

      <dt>gdd_crit</dt>
<dd><p>Critical value of GDD5 for turning ON growth season.</p></dd>

      <dt>betaON</dt>
<dd><p>Critical soil moisture for phenology onset.</p></dd>

      <dt>betaOFF</dt>
<dd><p>Critical soil moisture for phenology offset.</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>allometry parameters</b>:</dt>
<dd><dl><dt>alphaHT</dt>
<dd><p>Coefficient for allometry (height = alphaHT * DBH_m ** thetaHT), in m m\(^{-thetaHT}\).</p></dd>

      <dt>thetaHT</dt>
<dd><p>Coefficient for allometry (height = alphaHT * DBH_m ** thetaHT), in m m\(^{-thetaHT}\).</p></dd>

      <dt>alphaCA</dt>
<dd><p>Coefficient for allometry (projected crown area = pi * (alphaCA * DBH_m) ** thetaCA), in m\(^{2/thetaCA-1}\).</p></dd>

      <dt>thetaCA</dt>
<dd><p>Coefficient for allometry (projected crown area = pi * (alphaCA * DBH_m) ** thetaCA), unitless. Dybzinski (eq. G1) showed that thetaCA = theatBM - 1.</p></dd>

      <dt>alphaBM</dt>
<dd><p>Coefficient for allometry (biomass = alphaBM * DBH ** thetaBM), in kg C m\(^{-thetaBM}\).</p></dd>

      <dt>thetaBM</dt>
<dd><p>Coefficient for allometry (biomass = alphaBM * DBH ** thetaBM), unitless. Dybzinski (eq. G1) showed that thetaCA = theatBM - 1.</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>reproduction parameters</b>:</dt>
<dd><dl><dt>seedlingsize</dt>
<dd><p>Initial size of seedlings, in kg C per individual.</p></dd>

      <dt>maturalage</dt>
<dd><p>Age at which trees can reproduce (years).</p></dd>

      <dt>v_seed</dt>
<dd><p>Fraction of G_SF to G_F.</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>mortality parameters</b>:</dt>
<dd><dl><dt>mortrate_d_c</dt>
<dd><p>Canopy tree mortality rate (yr\(^{-1}\)).</p></dd>

      <dt>mortrate_d_u</dt>
<dd><p>Understory tree mortality rate (yr\(^{-1}\)).</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>leaf parameters</b>:</dt>
<dd><dl><dt>LMA</dt>
<dd><p>Leaf mass per unit area (kg C m\(^{-2}\)).</p></dd>

      <dt>leafLS</dt>
<dd><p>TODO</p></dd>

      <dt>LNbase</dt>
<dd><p>Basal leaf N per unit area, in kg N m\(^{-2}\).</p></dd>

      <dt>CNleafsupport</dt>
<dd><p>TODO</p></dd>

      <dt>rho_wood</dt>
<dd><p>Wood density (kg C m\(^{-3}\)).</p></dd>

      <dt>taperfactor</dt>
<dd><p>TODO</p></dd>

      <dt>lAImax</dt>
<dd><p>Maximum crown LAI (leaf area index).</p></dd>

      <dt>tauNSC</dt>
<dd><p>TODO</p></dd>

      <dt>fNSmax</dt>
<dd><p>Multiplier for NSNmax as sum of potential bl and br.</p></dd>

      <dt>phiCSA</dt>
<dd><p>Ratio of sapwood area to leaf area.</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>C/N ratios for plant pools</b>:</dt>
<dd><dl><dt>CNleaf0</dt>
<dd><p>TODO</p></dd>

      <dt>CNsw0</dt>
<dd><p>TODO</p></dd>

      <dt>CNwood0</dt>
<dd><p>TODO</p></dd>

      <dt>CNroot0</dt>
<dd><p>TODO</p></dd>

      <dt>CNseed0</dt>
<dd><p>TODO</p></dd>

      <dt>Nfixrate0</dt>
<dd><p>Reference N fixation rate (kg N kg C\(^{-1}\) root).</p></dd>

      <dt>NfixCost0</dt>
<dd><p>Carbon cost of N fixation (kg C kg N\(^{-1}\)).</p></dd>

      <dt>internal_gap_frac</dt>
<dd><p>TODO</p></dd>


</dl></dd>
<dt>The following columns pertaining to the <b>calibratable parameters</b>:</dt>
<dd><dl><dt>kphio</dt>
<dd><p>Quantum yield efficiency \(\varphi_0\), in mol mol\(^{-1}\).</p></dd>

      <dt>phiRL</dt>
<dd><p>Ratio of fine root to leaf area.</p></dd>

      <dt>LAI_light</dt>
<dd><p>Maximum LAI limited by light.</p></dd>


</dl></dd>

</dl></dd>

  <dt>init_cohort</dt>
<dd><p>A data.frame of initial cohort specifications, including
  the following data:</p><dl><dt>init_cohort_species</dt>
<dd><p>Index of a species described in param_species.</p></dd>

      <dt>init_cohort_nindivs</dt>
<dd><p>Initial individual density, in individuals per m\(^{2}\).</p></dd>

      <dt>init_cohort_bl</dt>
<dd><p>Initial biomass of leaf, in kg C per individual.</p></dd>

      <dt>init_cohort_br</dt>
<dd><p>Initial biomass of fine root, in kg C per individual.</p></dd>

      <dt>init_cohort_bsw</dt>
<dd><p>Initial biomass of sapwood, in kg C per individual.</p></dd>

      <dt>init_cohort_bHW</dt>
<dd><p>Initial biomass of heartwood, in kg C per individual.</p></dd>

      <dt>init_cohort_seedC</dt>
<dd><p>Initial biomass of seed, in kg C per individual.</p></dd>

      <dt>init_cohort_nsc</dt>
<dd><p>Initial non-structural biomass, in kg C per individual.</p></dd>

      <dt>lu_index</dt>
<dd><p>Land use type this cohorts belongs to (given as index in init_lu aray).
       Default: 0 (attach to all LU types except thoses which do not accept vegetation – cf  init_lu.vegetated).</p></dd>


</dl></dd>

  <dt>init_soil</dt>
<dd><p>A data.frame of initial soil pools, including
  the following data:</p><dl><dt>init_fast_soil_C</dt>
<dd><p>Initial fast soil carbon, in kg C m\(^{-2}\).</p></dd>

      <dt>init_slow_soil_C</dt>
<dd><p>Initial slow soil carbon, in kg C m\(^{-2}\).</p></dd>

      <dt>init_Nmineral</dt>
<dd><p>Mineral nitrogen pool, in kg N m\(^{-2}\).</p></dd>

      <dt>N_input</dt>
<dd><p>Annual nitrogen input to soil N pool, in kg N m\(^{-2}\) yr\(^{-1}\).</p></dd>


</dl></dd>

  <dt>init_lu</dt>
<dd><p>A data.frame of initial land unit (LU) specifications, including
    the following data:</p><dl><dt>fraction</dt>
<dd><p>Initial grid cell fraction occupied by this LU, dimensionless (0 to 1) or m\(^{-2}\) LU area per m\(^{-2}\) grid cell area.
        The sum of all fractions is typically equal to 1, but may be less in which case the difference is the fraction of the grid cell occupied by ice/water.</p></dd>

      <dt>preset</dt>
<dd><p>Predefined land use type (optional). One of: 'unmanaged', 'urban', 'cropland', 'pasture'. See below for meaning of these presets. Leave empty to not use any preset.</p></dd>

      <dt>vegetated</dt>
<dd><p>Whether this LU accepts vegetation. Default for preset 'urban': False, default for other presets: True.</p></dd>

      <dt>extra_N_input</dt>
<dd><p>Additional inorg N supply (to account for N fertiliser application), in kg m-2 yr-1. Default for preset 'cropland': 0.01, default other presets: 0.</p></dd>

      <dt>extra_turnover_rate</dt>
<dd><p>Additional soil turnover rate (to account for soil management such as tillage), dimensionless. Default for preset 'cropland': 0.2, default for other presets: 0.</p></dd>

      <dt>oxidized_litter_fraction</dt>
<dd><p>Fraction of above-ground turnover that is directly oxidized (crop and grass harvest), dimensionless.
        Default for preset 'cropland': 0.9, default for preset 'pasture': 0.4, default for other presets: 0.</p></dd>


</dl></dd>

  <dt>luc_forcing</dt>
<dd><p>Array of land use change (LUC) used during transient phase.
     During spinup, the initial land unit fractions are used (i.e. no transition).
     If there are more transient years than provided LUC data, the last state is maintained until the end of the transient phase (i.e. no transition).
     The array is a nxn square matrix, where n is the number of LU (i.e. dimension of init_lu).
     Each entry f(i, j) expresses the grid cell fraction of LU i (row) being transfered to LU j (column).
     I.e. same units as <code>init_lu$fraction</code>.
     Self transitions are allowed, meaning that a part of the land unit is clear cut, but the area remains in the same land use.</p></dd>


</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <!-- begin footer -->
<div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/geco-bern" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://geco-group.org" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/SteniBocker/" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://geco-group.org/" class="external-link">GECO</a></li>
                            <li><a href="https://geco-group.org/people/" class="external-link">Our Team</a></li>
                            <li><a href="https://geco-group.org/contact/" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/geco-bern" class="external-link">Packages</a></li>
                            <li><a href="https://geco-group.org/publication/" class="external-link">Publications</a></li>
                            <li><a href="https://geco-group.org/post/" class="external-link">Blog</a></li>
                        </ul></div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

  </div></footer></body></html>

